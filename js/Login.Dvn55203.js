import{a as y,b as h,c as k,d as b}from"./element-plus.Di1ZBkxc.js";import{a9 as x,r as I,t as O,C as V,c as E,a as m,O as a,L as d,aa as P,P as f,ab as w,ac as S,o as T,a1 as N}from"./vendor.BRzWipuI.js";function _(s){s.headers.token=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).token:"";const r=x.create({headers:s.headers,baseURL:"https://nocodenolife.net/richiea1y/",timeout:3e4,transformRequest:[(e=s.params)=>o(JSON.stringify(e)).data]}),o=e=>{for(const u in e)if(e.hasOwnProperty(u)){const n=e[u];(n===""||n===void 0)&&delete e[u]}return{data:encodeURIComponent(btoa(encodeURIComponent(e)))}};return r.interceptors.request.use(e=>e,e=>{console.log(e),Promise.reject(e)}),r.interceptors.response.use(e=>e,e=>{if(e.response)switch(e.response.status){case 400:console.error("400 Bad Request");break;case 404:console.error("404 Not Found");break;case 500:console.error("500 Internal Server Error");break;default:console.error(`Error: ${e.response.status}`)}else console.error("Network Error or Request Timed Out");return Promise.reject(e)}),r(s)}console.log("production");const C=s=>_({url:"/admin/otp",method:"get",headers:{"Content-Type":"text/plain"},params:s}),R=s=>_({url:"/admin/login",method:"post",headers:{"Content-Type":"text/plain"},params:s}),U={class:"flex flex-col h-[100vh] items-center justify-center"},B={class:"login-block"},D={class:"login-form"},q={__name:"Login",setup(s){const r=S(),o=I({username:"",password:"",otp:""}),e=async()=>{const[n,t]=await w(C());console.log("OTP:",t),t.status===200&&(o.value.otp=t.data.Data.OTP)},l=async()=>{const[n,t]=await w(R({Account:o.value.username,Password:o.value.password,OTP:o.value.otp}));console.log("###Login:",t),t.status===200&&(localStorage.setItem("token",t.data.Data.Token),localStorage.setItem("user",JSON.stringify(t.data.Data.Info)),r.push("/"))},u=n=>{n.key==="Enter"&&l()};return O(async()=>{await V(),await e()}),(n,t)=>{const i=b,p=k,g=y,v=h;return T(),E("div",U,[m("div",B,[m("div",D,[t[4]||(t[4]=m("h1",null,"Admin Backoffice",-1)),a(g,{onSubmit:f(l,["prevent"]),onKeydown:P(f(u,["prevent"]),["enter"])},{default:d(()=>[a(p,null,{default:d(()=>[a(i,{modelValue:o.value.username,"onUpdate:modelValue":t[0]||(t[0]=c=>o.value.username=c),type:"text",placeholder:"Username"},null,8,["modelValue"])]),_:1}),a(p,null,{default:d(()=>[a(i,{modelValue:o.value.password,"onUpdate:modelValue":t[1]||(t[1]=c=>o.value.password=c),type:"password",placeholder:"Password"},null,8,["modelValue"])]),_:1}),a(p,null,{default:d(()=>[a(i,{modelValue:o.value.otp,"onUpdate:modelValue":t[2]||(t[2]=c=>o.value.otp=c),type:"text",placeholder:"OTP"},null,8,["modelValue"])]),_:1})]),_:1},8,["onKeydown"]),a(v,{type:"success",onClick:l},{default:d(()=>t[3]||(t[3]=[N("Login")])),_:1})])])])}}};export{q as default};
